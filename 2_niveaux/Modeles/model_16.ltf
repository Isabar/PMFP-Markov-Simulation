set default
set echoin 1

MODEL:

SETS:
Clients: demand, EC, penalty;
Facilities: Cap;
F;
Levels;
SORTED(Clients,Facilities):sort, positions, P, distance;
LINK2(Clients,F): proba;
LINKS(Facilities, levels): cost,z;
ENDSETS

DATA:
Number_clients=@ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Instances/instance16.xlsx','NbClients');
Number_facilities=@ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Instances/instance16.xlsx','NbFacilities');
Number_levels=@ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Instances/instance16.xlsx','NbLevels');
N2=@ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Instances/instance16.xlsx','n');
Clients=1..Number_clients;
Facilities=1..Number_facilities; 
F=1..N2;
Levels=1..Number_levels; 
demand = @ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Instances/instance16.xlsx','Demandes');
penalty = @ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Instances/instance16.xlsx','Penalites');
distance = @ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Instances/instance16.xlsx','Distances');
cost = @ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Instances/instance16.xlsx','Cout');
proba = @ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Instances/instance16.xlsx','Proba');
!Results;
@ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Resultats/resultat_16.xlsx','B2')=@WRITE('Objectif');
@ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Resultats/resultat_16.xlsx','C2')=@WRITE(H1+H2);
@ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Resultats/resultat_16.xlsx','B3')=@WRITEFOR(LINKS(k,l):z(k,l));
@ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Resultats/resultat_16.xlsx','D2')=@WRITE(' The resolution time is : ',@TIME(),' seconds',@NEWLINE(1));

@ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Resultats/resultat_16.xlsx','C3')=@WRITEFOR(Facilities(k):Cap(k));
@ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Resultats/resultat_16.xlsx','D3')=@WRITE('H1');
@ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Resultats/resultat_16.xlsx','D4')=@WRITE(H1);
@ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Resultats/resultat_16.xlsx','E3')=@WRITE('H2');
@ole('C:/Users/baret/Documents/GitHub/PMFP-Markov-Simulation/2_niveaux/Resultats/resultat_16.xlsx','E4')=@WRITE(H2);
ENDDATA

!Objective function;
[obj] Min=H1+H2;

H1=(@sum(Clients(i):demand(i)*@sum(SORTED(i,k1): proba(i,k1)*distance(i,k1))));
H2=(@sum(Clients(i):proba(i,N2)*penalty(i)*demand(i)));
END

set terseo 1
set MULTIS 3
 go
nonz volume
quit
